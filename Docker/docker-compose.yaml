version: "3"
services:
  # vector database
  qdrant:
    image: qdrant/qdrant:latest
    container_name: qdrant_db
    volumes:
      - /opt/searcher/qdrant_storage:/qdrant/storage
    ports:
      - "6333:6333"
    restart: unless-stopped

  # application
  search-service:
    image: naumen/support-search:1.0.0
    container_name: searcher
    volumes:
      - /opt/searcher/configs/config.yaml:/app/config.yaml
      - /opt/searcher/configs/config.py:/app/config.py
      - /opt/searcher/models/bert:/app/models/bert
    ports:
      - "5000:5000"
    command: uvicorn app:app --workers 1 --host 0.0.0.0 --port 5000
    restart: unless-stopped